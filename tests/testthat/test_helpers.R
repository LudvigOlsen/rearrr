library(rearrr)
context("helpers")

test_that("to_unit_vector_()", {
  # Set seed
  xpectr::set_test_seed(42)

  vec1 <- runif(10)
  vecNormed <- to_unit_vector_(vec1)


  ## Testing 'vecNormed'                                                    ####
  ## Initially generated by xpectr
  xpectr::set_test_seed(42)
  # Testing class
  expect_equal(
    class(vecNormed),
    "numeric",
    fixed = TRUE)
  # Testing type
  expect_type(
    vecNormed,
    type = "double")
  # Testing values
  expect_equal(
    vecNormed,
    c(0.4239, 0.43422, 0.13259, 0.38481, 0.29737, 0.24054, 0.34132,
      0.0624, 0.30444, 0.32671),
    tolerance = 1e-4)
  # Testing names
  expect_equal(
    names(vecNormed),
    NULL,
    fixed = TRUE)
  # Testing length
  expect_equal(
    length(vecNormed),
    10L)
  # Testing sum of element lengths
  expect_equal(
    sum(xpectr::element_lengths(vecNormed)),
    10L)
  ## Finished testing 'vecNormed'                                           ####


  ## Testing 'sqrt(sum(vecNormed^2))'                                       ####
  ## Initially generated by xpectr
  xpectr::set_test_seed(42)
  # Assigning output
  output_19148 <- sqrt(sum(vecNormed^2))
  # Testing class
  expect_equal(
    class(output_19148),
    "numeric",
    fixed = TRUE)
  # Testing type
  expect_type(
    output_19148,
    type = "double")
  # Testing values
  expect_equal(
    output_19148,
    1,
    tolerance = 1e-4)
  # Testing names
  expect_equal(
    names(output_19148),
    NULL,
    fixed = TRUE)
  # Testing length
  expect_equal(
    length(output_19148),
    1L)
  # Testing sum of element lengths
  expect_equal(
    sum(xpectr::element_lengths(output_19148)),
    1L)
  ## Finished testing 'sqrt(sum(vecNormed^2))'                              ####


  # Generate expectations for 'to_unit_vector_'
  # Tip: comment out the gxs_function() call
  # so it is easy to regenerate the tests
  xpectr::set_test_seed(42)
  # xpectr::gxs_function(
  #   fn = to_unit_vector_,
  #   args_values = list(
  #     "x" = list(c(1,1,1), c(0,0,0), 1, 0, "hej", NA)
  #   ),
  #   indentation = 2,
  #   copy_env = FALSE
  # )


  ## Testing 'to_unit_vector_'                                                 ####
  ## Initially generated by xpectr
  # Testing different combinations of argument values

  # Testing to_unit_vector_(x = c(1, 1, 1))
  xpectr::set_test_seed(42)
  # Assigning output
  output_19148 <- to_unit_vector_(x = c(1, 1, 1))
  # Testing class
  expect_equal(
    class(output_19148),
    "numeric",
    fixed = TRUE)
  # Testing type
  expect_type(
    output_19148,
    type = "double")
  # Testing values
  expect_equal(
    output_19148,
    c(0.57735, 0.57735, 0.57735),
    tolerance = 1e-4)
  # Testing names
  expect_equal(
    names(output_19148),
    NULL,
    fixed = TRUE)
  # Testing length
  expect_equal(
    length(output_19148),
    3L)
  # Testing sum of element lengths
  expect_equal(
    sum(xpectr::element_lengths(output_19148)),
    3L)

  # Testing to_unit_vector_(x = c(0, 0, 0))
  # Changed from baseline: x = c(0, 0, 0)
  xpectr::set_test_seed(42)
  # Assigning output
  output_19370 <- to_unit_vector_(x = c(0, 0, 0))
  # Testing class
  expect_equal(
    class(output_19370),
    "numeric",
    fixed = TRUE)
  # Testing type
  expect_type(
    output_19370,
    type = "double")
  # Testing values
  expect_equal(
    output_19370,
    c(0, 0, 0),
    tolerance = 1e-4)
  # Testing names
  expect_equal(
    names(output_19370),
    NULL,
    fixed = TRUE)
  # Testing length
  expect_equal(
    length(output_19370),
    3L)
  # Testing sum of element lengths
  expect_equal(
    sum(xpectr::element_lengths(output_19370)),
    3L)

  # Testing to_unit_vector_(x = 1)
  # Changed from baseline: x = 1
  xpectr::set_test_seed(42)
  # Assigning output
  output_12861 <- to_unit_vector_(x = 1)
  # Testing class
  expect_equal(
    class(output_12861),
    "numeric",
    fixed = TRUE)
  # Testing type
  expect_type(
    output_12861,
    type = "double")
  # Testing values
  expect_equal(
    output_12861,
    1,
    tolerance = 1e-4)
  # Testing names
  expect_equal(
    names(output_12861),
    NULL,
    fixed = TRUE)
  # Testing length
  expect_equal(
    length(output_12861),
    1L)
  # Testing sum of element lengths
  expect_equal(
    sum(xpectr::element_lengths(output_12861)),
    1L)

  # Testing to_unit_vector_(x = 0)
  # Changed from baseline: x = 0
  xpectr::set_test_seed(42)
  # Assigning output
  output_18304 <- to_unit_vector_(x = 0)
  # Testing class
  expect_equal(
    class(output_18304),
    "numeric",
    fixed = TRUE)
  # Testing type
  expect_type(
    output_18304,
    type = "double")
  # Testing values
  expect_equal(
    output_18304,
    0,
    tolerance = 1e-4)
  # Testing names
  expect_equal(
    names(output_18304),
    NULL,
    fixed = TRUE)
  # Testing length
  expect_equal(
    length(output_18304),
    1L)
  # Testing sum of element lengths
  expect_equal(
    sum(xpectr::element_lengths(output_18304)),
    1L)

  # Testing to_unit_vector_(x = "hej")
  # Changed from baseline: x = "hej"
  xpectr::set_test_seed(42)
  # Testing side effects
  # Assigning side effects
  side_effects_16417 <- xpectr::capture_side_effects(to_unit_vector_(x = "hej"), reset_seed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_16417[['error']]),
    xpectr::strip("Assertion on 'x' failed: Must be of type 'numeric', not 'character'."),
    fixed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_16417[['error_class']]),
    xpectr::strip(c("simpleError", "error", "condition")),
    fixed = TRUE)

  # Testing to_unit_vector_(x = NA)
  # Changed from baseline: x = NA
  xpectr::set_test_seed(42)
  # Testing side effects
  # Assigning side effects
  side_effects_15190 <- xpectr::capture_side_effects(to_unit_vector_(x = NA), reset_seed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_15190[['error']]),
    xpectr::strip("Assertion on 'x' failed: Contains missing values (element 1)."),
    fixed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_15190[['error_class']]),
    xpectr::strip(c("simpleError", "error", "condition")),
    fixed = TRUE)

  # Testing to_unit_vector_(x = NULL)
  # Changed from baseline: x = NULL
  xpectr::set_test_seed(42)
  # Testing side effects
  # Assigning side effects
  side_effects_17365 <- xpectr::capture_side_effects(to_unit_vector_(x = NULL), reset_seed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_17365[['error']]),
    xpectr::strip("Assertion on 'x' failed: Must be of type 'numeric', not 'NULL'."),
    fixed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_17365[['error_class']]),
    xpectr::strip(c("simpleError", "error", "condition")),
    fixed = TRUE)

  ## Finished testing 'to_unit_vector_'                                        ####
  #

})
