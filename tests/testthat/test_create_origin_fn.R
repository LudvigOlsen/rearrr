library(rearrr)
context("create_origin_fn()")

test_that("create_origin_fn()", {

  # Create an origin function
  median_origin_fn <- create_origin_fn(median)

  ## Testing 'median_origin_fn'                                             ####
  ## Initially generated by xpectr
  xpectr::set_test_seed(42)
  # Testing is function
  expect_true(
    is.function(median_origin_fn))
  # Testing argument names and default values
  expect_equal(
    xpectr::simplified_formals(median_origin_fn),
    "...",
    fixed = TRUE)
  # Testing function definition
  expect_equal(
    deparse(median_origin_fn),
    c("function (...) ", "{", "    list(...) %>% purrr::map(fn) %>% unlist(recursive = TRUE, ",
      "        use.names = FALSE)", "}"),
    fixed = TRUE)
  ## Finished testing 'median_origin_fn'                                    ####



  ## Testing 'median_origin_fn(c(1,2,3), c(9,8,6,3), c(42,...'              ####
  ## Initially generated by xpectr
  xpectr::set_test_seed(42)
  # Assigning output
  output_19148 <- median_origin_fn(c(1,2,3), c(9,8,6,3), c(42,6,3,1))
  # Testing class
  expect_equal(
    class(output_19148),
    "numeric",
    fixed = TRUE)
  # Testing type
  expect_type(
    output_19148,
    type = "double")
  # Testing values
  expect_equal(
    output_19148,
    c(2, 7, 4.5),
    tolerance = 1e-4)
  # Testing names
  expect_equal(
    names(output_19148),
    NULL,
    fixed = TRUE)
  # Testing length
  expect_equal(
    length(output_19148),
    3L)
  # Testing sum of element lengths
  expect_equal(
    sum(xpectr::element_lengths(output_19148)),
    3L)
  ## Finished testing 'median_origin_fn(c(1,2,3), c(9,8,6,3), c(42,...'     ####

})

test_that("centroid()", {

  ## Testing 'centroid(c(1,2,3), c(9,8,6,3), c(42,6,3,1))'                  ####
  ## Initially generated by xpectr
  xpectr::set_test_seed(42)
  # Assigning output
  output_19148 <- centroid(c(1,2,3), c(9,8,6,3), c(42,6,3,1))
  # Testing class
  expect_equal(
    class(output_19148),
    "numeric",
    fixed = TRUE)
  # Testing type
  expect_type(
    output_19148,
    type = "double")
  # Testing values
  expect_equal(
    output_19148,
    c(2, 6.5, 13),
    tolerance = 1e-4)
  # Testing names
  expect_equal(
    names(output_19148),
    NULL,
    fixed = TRUE)
  # Testing length
  expect_equal(
    length(output_19148),
    3L)
  # Testing sum of element lengths
  expect_equal(
    sum(xpectr::element_lengths(output_19148)),
    3L)
  ## Finished testing 'centroid(c(1,2,3), c(9,8,6,3), c(42,6,3,1))'         ####

})
